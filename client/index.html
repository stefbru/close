<!DOCTYPE>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="./style.css">
	<!-- no need for jquery so far -->
	<!--script src="jquery/jquery-1.11.1.min.js"></script-->
</head>
<body>
	<!-- i hope you are using these divs in css, otherwise the html can be made more simple -->
	<div class="wrapper">
	<main>
		<div id="container">
			<div id ="player-list">"online:"
				<div class="player">
					<ul id="num-players">
					</ul>
				</div>
			</div> 
		</div>
		<div id="client"></div>
	</main>
	</div>
<script>
	var ul = document.getElementById('num-players');
	var clientId = 0;
	var name = "";
	var emoji = "";
	var gif = "";
	var players = {};
	var ws = new WebSocket('ws://localhost:5000');

	function html(text) {
		if (!text)
			return '';
		return text
			.replace(/&/g, '&amp;')
			.replace(/</g, '&lt;')
			.replace(/>/g, '&gt;')
			.replace(/"/g, '&quot;');
	}

	ws.onmessage = function(e) {
		var message = JSON.parse(e.data);
		switch (message.action) {
			case 'hello':
				name = prompt("What is your name?");
				ws.send(JSON.stringify({
					action: 'connect',
					name: name
				}));
				break;

			case 'connect':
				// someone connected, add him to the list
				var player = players[message.name] = {
					name: message.name,
					emoji: message.emoji,
					id: ++clientId
				};
			 	var li = document.createElement('li');
			 	li.id = 'player-' + player.id; 
			 	li.innerHTML = [
			 		'<img src="images/runningman.gif" />',
			 		'<span class="emoji">', html(player.emoji), '</span>',
			 		'<b>', html(player.name), '</b>'
			 	].join('');
			 	ul.appendChild(li)
				break;

			case 'disconnect': 
				// someone disconnected, remove him from the list
				var player = players[message.name];
				delete players[message.name];
				var el = document.getElementById('player-' + player.id);
				el.parentNode.removeChild(el);
				break;
		}
	};
</script>

</body>
</html>